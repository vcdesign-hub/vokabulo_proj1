---
import BaseLayout from '../layouts/BaseLayout.astro';
import { loadHomeCopy } from '../utils/home';
import '../styles/global.css';

// 1. IMPORT YOUR NEW JSON DATA
import homeData from '../data/home_marquee.json';

// Redirect root to /en/ by rendering the same content
const lang = 'en';
const home = loadHomeCopy('en');

// 2. DESTRUCTURE THE ORIGINAL CONTENT (Required for HTML)
const { hero, philosophy, featureBlocks, features, testimonials, faq, cta } = home;

// 3. DESTRUCTURE THE NEW JSON DATA (Only do this once)
const { philosophyVisuals, vocabMarquee, heroBadges } = homeData;
---

<BaseLayout title={hero.title} description={hero.description} currentLang={lang} currentPath="">
  
  <section
    id="hero"
    class="hero-animate relative w-full px-4 pt-32 pb-16 md:px-6 md:pt-40 md:pb-20 min-h-screen flex flex-col md:flex-row items-center justify-center gap-8 md:gap-20"
  >
    <div class="relative z-10 flex max-w-6xl flex-col md:flex-row items-center justify-center gap-12 md:gap-24 w-full mx-auto">
      
      <div class="w-full md:w-auto text-left space-y-6 max-w-2xl pb-20 md:pb-32">
        <h1
          class="animate-fade-up text-5xl font-bold leading-[1.3] tracking-tight text-slate-900 sm:text-6xl sm:leading-[1.3]"
          style="animation-delay: 0.2s;"
          set:html={hero.heroHeadingHtml}
        />

        <p 
          class="animate-fade-up text-lg text-slate-700 sm:text-xl max-w-lg leading-relaxed"
          style="animation-delay: 0.4s;"
        >
          {hero.heroSubheading}
        </p>

        <div 
          class="animate-fade-up flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-start pt-2"
          style="animation-delay: 0.6s;"
        >
          <a class="btn-accent px-8 py-4 text-base font-semibold shadow-lg hover:shadow-xl transition-all" href={hero.ctaHref}>
            {hero.ctaText}
          </a>
        </div>
      </div>

      <div class="relative z-10 flex-shrink-0 perspective-container">
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-blue-500/20 rounded-full blur-[100px] -z-10 animate-pulse-slow"></div>
        <div class="relative mx-auto translate-y-12 animate-phone-entry">
          
          <div 
            class="floating-badge" 
            style="top: 280px; left: -60px; animation: popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 2.0s;"
          >
            <div class="flex items-center justify-center w-8 h-8 bg-blue-100 rounded-full text-blue-600">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5v14M5 12h14"/></svg>
            </div>
            <div>
              <div class="badge-title">{heroBadges.card1.title}</div>
              <div class="badge-sub">{heroBadges.card1.sub}</div>
            </div>
          </div>
      
          <div 
            class="floating-badge" 
            style="top: 140px; right: -50px; animation: popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 2.4s;"
          >
            <div class="flex items-center justify-center w-8 h-8 bg-orange-100 rounded-full text-orange-500">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.25a.75.75 0 01.75.75v2.25a.75.75 0 01-1.5 0V3a.75.75 0 01.75-.75zM7.5 12a4.5 4.5 0 119 0 4.5 4.5 0 01-9 0zM18.894 6.166a.75.75 0 00-1.06-1.06l-1.591 1.59a.75.75 0 101.061 1.061l1.59-1.59zM21.75 12a.75.75 0 01-.75.75h-2.25a.75.75 0 010-1.5H21a.75.75 0 01.75.75zM17.834 18.894a.75.75 0 001.061-1.06l-1.59-1.591a.75.75 0 10-1.061 1.061l1.59 1.59zM12 18a.75.75 0 01.75.75V21a.75.75 0 01-1.5 0v-2.25A.75.75 0 0112 18zM7.758 17.303a.75.75 0 00-1.061-1.06l-1.591 1.59a.75.75 0 001.06 1.061l1.591-1.59zM6 12a.75.75 0 01-.75.75H3a.75.75 0 010-1.5h2.25A.75.75 0 016 12zM6.697 7.757a.75.75 0 001.06-1.06l-1.59-1.591a.75.75 0 00-1.061 1.06l1.591 1.59z" /></svg>
            </div>
            <div>
              <div class="badge-title">{heroBadges.card2.title}</div>
              <div class="badge-sub">{heroBadges.card2.sub}</div>
            </div>
          </div>
      
          <div 
            class="floating-badge" 
            style="bottom: 80px; right: -70px; animation: popIn 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards 2.8s;"
          >
            <div class="flex items-center justify-center w-8 h-8 bg-green-100 rounded-full text-green-600">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>
            </div>
            <div>
              <div class="badge-title">{heroBadges.card3.title}</div>
              <div class="badge-sub">{heroBadges.card3.sub}</div>
            </div>
          </div>
      
          <div class="iphone-13">
            <div class="outside-border">
              <div class="silencer"></div>
              <div class="volume-up"></div>
              <div class="volume-down"></div>
              <div class="button-on"></div>
              <div class="inside-border">
                <div class="screen-content">
                  <video 
                    id="hero-video"
                    src="/images/home/hero-video.mp4" 
                    loop 
                    muted 
                    playsinline 
                    poster="/images/home/hero phone.jpg"
                    class="w-full h-full object-cover rounded-[32px]"
                  ></video>
                </div>
                <div class="bottom-line"></div>
              </div>
            </div>
          </div>
      
        </div>
      </div>
    </div>
  </section>

  <main class="mx-auto max-w-5xl space-y-16 px-4 pb-16 pt-12 md:space-y-24 md:px-6 md:pt-16">
    
    <section id="philosophy" class="space-y-10 px-4 pt-8 md:pt-12">
      <div class="mx-auto max-w-4xl space-y-3 text-center">
        <p class="text-sm font-semibold uppercase tracking-[0.16em] text-slate-600">{philosophy.kicker}</p>
        <h2 class="text-3xl font-semibold tracking-tight text-slate-900 sm:text-4xl">
          {philosophy.heading}
        </h2>
        <p class="text-lg leading-relaxed text-slate-700 sm:text-xl">
          {philosophy.subheading}
        </p>
      </div>

      <div class="mx-auto grid max-w-5xl gap-4 md:grid-cols-3">
        
        <article class="card js-visual-trigger flex h-full flex-col gap-3 rounded-2xl p-6 shadow-soft group">
          <div class="bg-accent inline-flex h-10 w-10 items-center justify-center rounded-full text-white shadow-soft">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"/><line x1="16" y1="8" x2="2" y2="22"/><line x1="17.5" y1="15" x2="9" y2="15"/></svg>
          </div>
          <h3 class="text-lg font-semibold text-slate-900">{philosophy.cards[0]?.title}</h3>
          <p class="text-sm text-slate-600">
            {philosophy.cards[0]?.body}
          </p>
          <div class="card-visual">
            <div class="visual-note anim-hidden" style="animation-delay: 0.1s;">
              <div class="note-line medium"></div>
              <div class="note-line"></div>
              <div class="note-line short"></div>
              <div class="note-badge anim-hidden absolute bottom-3 right-3 h-6 w-6 rounded flex items-center justify-center shadow-sm" style="animation-delay: 0.6s;">
                 <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M20 6L9 17l-5-5"/></svg>
              </div>
            </div>
          </div>
        </article>

        <article class="card js-visual-trigger flex h-full flex-col gap-3 rounded-2xl p-6 shadow-soft group">
          <div class="bg-accent inline-flex h-10 w-10 items-center justify-center rounded-full text-white shadow-soft">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 12C2 6.5 6.5 2 12 2a10 10 0 0 1 8 6"/><path d="M5 15.1A2 2 0 0 0 6.5 16c1.1 0 2-.9 2-2 0-.6.9-1 1.5-1 1.1 0 2 1.3 2 4v2"/><path d="M12 22v-7a2.9 2.9 0 0 0-2.9-2.9c-.9 0-1.6.4-2.1 1.1"/><path d="M22 13a10.9 10.9 0 0 0-2.1-5.7"/><path d="M16 22v-5.5a2.5 2.5 0 0 0-5 0v3.5"/></svg>
          </div>
          <h3 class="text-lg font-semibold text-slate-900">{philosophy.cards[1]?.title}</h3>
          <p class="text-sm text-slate-600">
            {philosophy.cards[1]?.body}
          </p>
          <div class="card-visual">
             <div class="visual-flow">
               <div class="flow-icon anim-hidden" style="animation-delay: 0.1s;">
                  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>
               </div>
               <div class="flow-arrow anim-hidden" style="animation-delay: 0.4s;">
                 <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg>
               </div>
               <div class="flow-list">
                 {philosophyVisuals.flowTags.map((tag, i) => (
                    <div class="flow-tag anim-hidden" style={`animation-delay: ${0.7 + (i * 0.2)}s;`}>{tag}</div>
                 ))}
               </div>
             </div>
          </div>
        </article>

        <article class="card js-visual-trigger flex h-full flex-col gap-3 rounded-2xl p-6 shadow-soft group">
          <div class="bg-accent inline-flex h-10 w-10 items-center justify-center rounded-full text-white shadow-soft">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          </div>
          <h3 class="text-lg font-semibold text-slate-900">{philosophy.cards[2]?.title}</h3>
          <p class="text-sm text-slate-600">
            {philosophy.cards[2]?.body}
          </p>
          <div class="card-visual">
            <div class="visual-community">
              <div class="comm-bubble left anim-hidden" style="animation-delay: 0.2s;">
                {philosophyVisuals.chat.question}
              </div>
              <div class="comm-bubble right anim-hidden" style="animation-delay: 1.2s;">
                {philosophyVisuals.chat.reply}
              </div>
            </div>
          </div>
        </article>

      </div>
    </section>

    <section id="feature-blocks" class="space-y-12 pt-4 md:space-y-16">
      <div class="space-y-3 text-center">
        <p class="text-sm font-semibold uppercase tracking-[0.12em] text-slate-600">{featureBlocks.kicker}</p>
        <h2 class="text-3xl font-semibold text-slate-900 sm:text-4xl">{featureBlocks.heading}</h2>
        <p class="text-lg leading-relaxed text-slate-700 sm:text-xl">
          {featureBlocks.subheading}
        </p>
      </div>

      <div class="features-accordion mx-auto max-w-6xl">
        {featureBlocks.blocks.map((block, index) => (
          <div class={`feature-card group ${index === 0 ? 'active' : ''}`} data-index={index}>
            <div class="f-inactive-layer hidden md:flex">
              <div class="f-icon-circle">
                {index === 0 && <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.24 12.24a6 6 0 0 0-8.49-8.49L5 10.5V19h8.5z"/><line x1="16" y1="8" x2="2" y2="22"/><line x1="17.5" y1="15" x2="9" y2="15"/></svg>}
                {index === 1 && <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/></svg>}
                {index === 2 && <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>}
                {index === 3 && <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>}
              </div>
              <div class="f-inactive-title">{block.title}</div>
            </div>
            <div class="f-active-layer">
              // ... inside the featureBlocks.blocks.map loop ...
              <div class="f-image-top">
                {index === 0 && (
                  <img 
                    src="/images/blog/eye.jpg" 
                    alt={block.title}  
                    class="w-full h-full object-cover" 
                  />
                )}
                {index === 1 && (
                  <img 
                    src="/images/blog/Hand reaching.jpg" 
                    alt={block.title} 
                    class="w-full h-full object-cover" 
                  />
                )}
                {index === 2 && (
                  <img 
                    src="/images/blog/Moon rising.jpg" 
                    alt={block.title} 
                    class="w-full h-full object-cover" 
                  />
                )}
                {index === 3 && (
                  <img 
                    src="/images/blog/Ocean.jpg" 
                    alt={block.title} 
                    class="w-full h-full object-cover" 
                  />
                )}
              </div>
              <div class="f-content-bottom">
                <div class="space-y-4">
                  <div class="bg-accent inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold text-white shadow-sm w-fit">
                    {block.label}
                  </div>
                  <h3 class="text-2xl font-semibold text-slate-900">{block.title}</h3>
                  <p class="text-base text-slate-600">{block.body}</p>
                  <div class="flex flex-wrap gap-2 text-sm">
                    {block.pills?.map((pill, idx) => (
                      <span class={`rounded-full px-3 py-1 ${idx === 0 ? 'bg-slate-900 text-white' : 'border border-slate-200 bg-white text-slate-600'}`}>
                        {pill}
                      </span>
                    ))}
                  </div>
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>
    </section>

    <section id="vocab-marquee" class="py-20 overflow-hidden space-y-8">
      <div class="text-center space-y-3 px-4">
        <p class="text-sm font-semibold uppercase tracking-[0.12em] text-slate-600">{vocabMarquee.kicker}</p>
        <h2 class="text-3xl font-semibold text-slate-900 sm:text-4xl">{vocabMarquee.heading}</h2>
      </div>

      <div class="marquee-container">
        <div class="marquee-track marquee-left">
          {[...Array(2)].map(() => (
            <div class="flex gap-6">
              {vocabMarquee.row1.map((item) => (
                <div class="vocab-pill">
                  <svg class="vocab-icon w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
                  <span>{item.text}</span>
                </div>
              ))}
            </div>
          ))}
        </div>
      </div>

      <div class="marquee-container">
        <div class="marquee-track marquee-right">
          {[...Array(2)].map(() => (
            <div class="flex gap-6">
              {vocabMarquee.row2.map((item) => (
                <div class="vocab-pill">
                  <svg class="vocab-icon w-4 h-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" /></svg>
                  <span>{item.text}</span>
                </div>
              ))}
            </div>
          ))}
        </div>
      </div>
    </section>

    <section id="features" class="space-y-8">
      <div class="flex flex-col gap-3">
        <p class="text-sm font-semibold uppercase tracking-[0.12em] text-slate-500">{features.kicker}</p>
        <h2 class="text-2xl font-semibold text-slate-900 sm:text-3xl">{features.heading}</h2>
        <p class="max-w-3xl text-base text-slate-600">{features.subheading}</p>
      </div>
      <div class="grid gap-6 md:grid-cols-3">
        {features.cards.map((card, i) => (
           <article class="card flex flex-col gap-4 p-6 transition hover:-translate-y-1 hover:shadow-soft">
              <div class="flex h-10 w-10 items-center justify-center rounded-2xl bg-slate-900 text-white">
                {i === 0 ? '↻' : i === 1 ? '✔' : '⚡'}
              </div>
              <h3 class="text-lg font-semibold text-slate-900">{card.title}</h3>
              <p class="text-sm text-slate-600">{card.body}</p>
           </article>
        ))}
      </div>
    </section>

    <section id="testimonials" class="space-y-8">
      <div class="flex flex-col gap-3">
        <p class="text-sm font-semibold uppercase tracking-[0.12em] text-slate-500">{testimonials.kicker}</p>
        <h2 class="text-2xl font-semibold text-slate-900 sm:text-3xl">{testimonials.heading}</h2>
        <p class="max-w-3xl text-base text-slate-600">{testimonials.subheading}</p>
      </div>
      <div class="grid gap-6 md:grid-cols-3">
        {testimonials.items.map(item => (
          <article class="card flex flex-col gap-4 p-6 shadow-soft transition hover:-translate-y-1 hover:shadow-soft">
            <p class="text-sm text-slate-700">{item.quote}</p>
            <div class="text-sm font-semibold text-slate-900">{item.author}</div>
          </article>
        ))}
      </div>
    </section>

    <section id="faq" class="space-y-6">
      <div class="flex flex-col gap-3">
        <p class="text-sm font-semibold uppercase tracking-[0.12em] text-slate-500">{faq.kicker}</p>
        <h2 class="text-2xl font-semibold text-slate-900 sm:text-3xl">{faq.heading}</h2>
        <p class="max-w-3xl text-base text-slate-600">{faq.subheading}</p>
      </div>
      <div class="space-y-3">
        {faq.items.map(item => (
          <details class="card group space-y-2 p-4">
            <summary class="flex cursor-pointer items-center justify-between gap-4 text-base font-semibold text-slate-900">
              {item.question}
              <span class="text-slate-400 transition group-open:rotate-45">+</span>
            </summary>
            <p class="pl-1 text-sm text-slate-600">{item.answer}</p>
          </details>
        ))}
      </div>
    </section>

    <section class="card flex flex-col items-center gap-4 p-8 text-center shadow-soft">
      <div class="inline-flex items-center gap-2 rounded-full border border-slate-200 bg-white px-3 py-1 text-xs font-semibold uppercase tracking-[0.14em] text-slate-700 shadow-sm">
        {cta.kicker}
      </div>
      <h2 class="text-2xl font-semibold text-slate-900 sm:text-3xl">{cta.heading}</h2>
      <p class="max-w-2xl text-base text-slate-600">{cta.subheading}</p>
      <div class="flex flex-col gap-3 sm:flex-row sm:items-center">
        <a class="btn-ghost border border-slate-200 px-5 py-3 text-sm font-semibold text-slate-800" href={cta.secondaryCtaHref}>
          {cta.secondaryCtaText}
        </a>
      </div>
    </section>
    
    <script>
      import "../scripts/global.js";
    </script>
  </main>
</BaseLayout>